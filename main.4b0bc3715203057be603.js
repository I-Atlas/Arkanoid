(()=>{"use strict";var t,e,i,n,a,r,o,h,s,l,c,d,f,u,E,y,w,g,T,p=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=i/1.5,this.height=i/1.5,this.x=r.x,this.y=r.y-r.height/2-this.height/2,this.speed=H.BALL_SPEED*e,this.speedX=0,this.speedY=0},x=function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.width=H.PADDLE_WIDTH*t,this.height=i,this.x=t/2,this.y=e-3*this.height,this.speed=H.PADDLE_SPEED*t,this.speedX=0},m=function t(e,i,n,a,r,o){var h=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=n,this.height=a,this.bottom=i+a,this.left=e,this.right=e+n,this.top=i,this.color=r,this.score=o,this.collision=function(t){var e=t.y-t.height/2,i=t.y+t.height/2,n=t.x-t.width/2,a=t.x+t.width/2;return e<h.bottom&&i>h.top&&n<h.right&&a>h.left}},v=function t(i,n,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=a,this.height=a,this.x=i,this.y=n,this.type=r,this.speedY=H.ENHANCEMENT_SPEED*e},b=[],S=[],I=function(){e=window.innerHeight,t=window.innerWidth,i=H.SIDE*(e<t?e:t),K.width=t,K.height=e,C()};window.addEventListener("resize",I);var C=function(){c=1,d=H.LIVES,f=0,w=!0,g=!1,T=!1;var t=localStorage.getItem(H.SCORE);u=null==t?0:t,L()},L=function(){M(),k()},M=function(){r=new x,a=new p,A()},A=function(){l=!1,s=!1,h=!1},R=function(t){t<Math.PI/6?t=Math.PI/6:t>5*Math.PI/6&&(t=5*Math.PI/6),a.speedX=a.speed*Math.cos(t),a.speedY=-a.speed*Math.sin(t)},P=function(t){switch(t){case U.left:r.speedX=-r.speed;break;case U.right:r.speedX=r.speed;break;case U.stop:r.speedX=0}},k=function(){for(var e,r,h,s,l,d,f=i,u=a.y-4.5*a.height,w=t-2*i,g=(u-f)/(H.BRICK_MARGIN+H.BRICK_ROWS+H.MAXIMUM_LEVEL),T=i*H.BRICK_GAP,p=H.BRICK_COLUMN,x=H.BRICK_ROWS+c-2,v=(w-T)/H.BRICK_COLUMN,S=g-T,I=v-T,C=0;C<x;C++){e=i+(H.BRICK_MARGIN+C)*g,n=5*i,s=Math.floor(C/2),l=x/2,E=g*H.BRICK_MARGIN/2,y=t-2*n,b[C]=[],o=p*x,h=N(s,l),d=2*(l-s);for(var L=0;L<p;L++)r=i+T+L*v,b[C][L]=new m(r,e,I,S,h,d)}},N=function(t,e){var i,n,a,r=t/e;return r<=.67?(i=255,n=255*r/.67,a=255*r/3):(i=255*(1-r)/.33,n=255,a=255*r/2),"rgb(".concat(i,", ").concat(n,", ").concat(a,")")};function O(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return B(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?B(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,h=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){h=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(h)throw r}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var D=function(){function p(){var n,E,y=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),E=function(n){y.lastTime||(y.lastTime=n),y.deltaTime=.001*(n-y.lastTime),y.lastTime=n,0!=g&&0!=T||(function(e){var n=r.x;r.x+=r.speedX*e,r.x<i+r.width/2?r.x=i+r.width/2:r.x>t-i-r.width/2&&(r.x=t-i-r.width/2),0==a.speedY&&0==a.speedY&&(a.x+=r.x-n);for(var o=S.length-1;o>=0;o--)if(S[o].x+S[o].width/2>r.x-r.width/2&&S[o].x-S[o].width/2<r.x+r.width/2&&S[o].y+S[o].height/2>r.y-r.height/2&&S[o].y-S[o].height/2<r.y+r.height/2){switch(S[o].type){case X.LIFE:++d>3&&(f+=10);break;case X.DEATH:0==--d&&(g=!0);break;case X.GLUE:1==h?f+=10:h=!0;break;case X.SUPER:1==s?f+=15:s=!0;break;case X.EXTENSION:1==l?f+=20:(l=!0,r.width*=2)}S.splice(o,1)}}(y.deltaTime),function(n){if(a.x+=a.speedX*n,a.y+=a.speedY*n,a.x<i+a.width/2?(a.x=i+a.width/2,a.speedX=-a.speedX):a.x>t-i-a.width/2?(a.x=t-i-a.width/2,a.speedX=-a.speedX):a.y<i+a.height/2&&(a.y=i+a.height/2,a.speedY=-a.speedY),a.y>r.y-r.height/2-a.height/2&&a.y<r.y&&a.x>r.x-r.width/2-a.width/2&&a.x<r.x+r.width/2+a.width/2)if(a.y=r.y-r.height/2-a.height/2,1==h)a.speedX=0,a.speedY=0;else{a.speedY=-a.speedY;var o=Math.atan2(-a.speedY,a.speedX);o+=(Math.random()*Math.PI/2-Math.PI/4)*H.BALL_SPIN,R(o)}a.y>e&&(0==--d&&(g=!0),M())}(y.deltaTime),function(){for(var t=0;t<b.length;t++)for(var e=0;e<H.BRICK_COLUMN;e++)if(null!=b[t][e]&&b[t][e].collision(a)){if(d=b[t][e].score,(f+=d)>u&&(u=f,localStorage.setItem(H.SCORE,u)),Math.random()<H.ENHANCEMENT_CHANCE){var i=b[t][e].left+b[t][e].width/2,n=b[t][e].top+b[t][e].width/2,r=b[t][e].width/2,h=Object.keys(X),l=h[Math.floor(Math.random()*h.length)];S.push(new v(i,n,r,X[l]))}0==s&&(a.speedY=-a.speedY),b[t][e]=null,o--;break}var d;0==o&&(c<H.MAXIMUM_LEVEL?(c++,L()):(g=!1,T=!0,M()))}(y.deltaTime),function(t){for(var i=S.length-1;i>=0;i--)S[i].y+=S[i].speedY*t,S[i].y-S[i].height/2>e&&S.splice(i,1)}(y.deltaTime)),y.drawBackground(),y.drawText(),y.drawSides(),y.drawBall(),y.drawPaddle(),y.drawBricks(),y.drawEnhancements(),requestAnimationFrame(y.drawGame)},(n="drawGame")in this?Object.defineProperty(this,n,{value:E,enumerable:!0,configurable:!0,writable:!0}):this[n]=E,this.backgroundColor="rgb(11, 31, 42)",this.sideColor="rgb(164, 170, 174)",this.ballColor="rgb(255, 255, 255)",this.paddleColor="rgb(66, 133, 244)",this.textColor="rgb(255, 255, 255)",this.fontText="Roboto",this.levelText="LEVEL",this.livesText="LIVES",this.scoreText="SCORE",this.bestScoreText="BEST",this.gameOverText="GAME OVER",this.gameStartText="PRESS SPACE TO START THE GAME",this.lifeEnhancementHint="‚ù§Ô∏è - ADDS 1 LIFE",this.deathEnhancementHint="‚ò†Ô∏è - REMOVES 1 LIFE",this.glueEnhancementHint="üîí - BALL STICKS TO PLATFORM",this.superEnhancementHint="üåÄ - BALL DOESN'T BOUNCE OFF BRICKS",this.extensionEnhancementHint="‚ú≥Ô∏è - X2 PLATFORM WIDTH",this.gameWinText="YOU WIN",this.deltaTime,this.lastTime}var x,m;return x=p,(m=[{key:"drawBackground",value:function(){G.fillStyle=this.backgroundColor,G.fillRect(0,0,t,e)}},{key:"drawText",value:function(){var e=y/5,a=E/2.5,o=t/2.5,h=n,s=t/1.7,l=t-n,p=i+a,x=p+E;if(G.fillStyle=this.textColor,G.font="".concat(a,"px ").concat(this.fontText),G.textAlign="center",G.fillText(this.levelText,o,p,e),G.fillText(c,o,x,e),G.fillText(this.livesText,h,p,e),G.fillText("".concat(d,"|").concat(H.LIVES),h,x,e),G.fillText(this.scoreText,s,p,e),G.fillText(f,s,x,e),G.fillText(this.bestScoreText,l,p,e),G.fillText(u,l,x,e),1==g||1==T){var m=g?this.gameOverText:this.gameWinText;G.fillText(m,t/2,r.y-E,y)}1==w&&(G.fillText(this.superEnhancementHint,t/2,r.y-E-300,y),G.fillText(this.glueEnhancementHint,t/2,r.y-E-230,y),G.fillText(this.extensionEnhancementHint,t/2,r.y-E-160,y),G.fillText(this.deathEnhancementHint,t/2,r.y-E-90,y),G.fillText(this.lifeEnhancementHint,t/2,r.y-E-20,y),G.fillText(this.gameStartText,t/2,r.y-E+70,y))}},{key:"drawSides",value:function(){var n=i/2;G.lineWidth=i,G.strokeStyle=this.sideColor,G.beginPath(),G.moveTo(n,e),G.lineTo(n,n),G.lineTo(t-n,n),G.lineTo(t-n,e),G.stroke()}},{key:"drawBall",value:function(){G.fillStyle=s?X.SUPER.color:this.ballColor,G.fillRect(a.x-a.width/2,a.y-a.height/2,a.width,a.height)}},{key:"drawPaddle",value:function(){G.fillStyle=h?X.GLUE.color:this.paddleColor,G.fillRect(r.x-r.width/2,r.y-r.height/2,r.width,r.height)}},{key:"drawBricks",value:function(){var t,e=O(b);try{for(e.s();!(t=e.n()).done;){var i,n=O(t.value);try{for(n.s();!(i=n.n()).done;){var a=i.value;null!=a&&(G.fillStyle=a.color,G.fillRect(a.left,a.top,a.width,a.height))}}catch(t){n.e(t)}finally{n.f()}}}catch(t){e.e(t)}finally{e.f()}}},{key:"drawEnhancements",value:function(){var t,e=O(S);try{for(e.s();!(t=e.n()).done;){var i=t.value;G.fillText(i.type.symbol,i.x,i.y)}}catch(t){e.e(t)}finally{e.f()}}}])&&_(x.prototype,m),p}(),H={SIDE:.03,BALL_SPEED:.5,BALL_SPIN:.2,PADDLE_SPEED:.6,PADDLE_WIDTH:.11,BRICK_ROWS:2,BRICK_COLUMN:6,BRICK_GAP:.3,BRICK_MARGIN:6,MAXIMUM_LEVEL:10,LIVES:3,SCORE:0,ENHANCEMENT_CHANCE:.2,ENHANCEMENT_SPEED:.15},X={LIFE:{color:"rgb(219,68,55)",symbol:"‚ù§Ô∏è"},DEATH:{color:"rgb(109,7,26)",symbol:"‚ò†Ô∏è"},GLUE:{color:"rgb(244,160,0)",symbol:"üîí"},SUPER:{color:"rgb(66,133,244)",symbol:"üåÄ"},EXTENSION:{color:"rgb(15,157,88)",symbol:"‚ú≥Ô∏è"}},Y=new D,U=new function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=0,this.right=1,this.stop=2,document.addEventListener("keydown",(function(t){switch(t.keyCode){case 32:!function(){if(w=!1,0!=a.speedY)return!1;var t=Math.random()*Math.PI/2+Math.PI/3;R(t)}(),1!=g&&1!=T||C();break;case 37:P(e.left);break;case 39:P(e.right)}})),document.addEventListener("keyup",(function(t){switch(t.keyCode){case 37:case 39:P(e.stop)}}))},K=document.getElementById("arkanoid"),G=K.getContext("2d");requestAnimationFrame(Y.drawGame),I()})();